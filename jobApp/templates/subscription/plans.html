{% extends 'base.html' %}
{% load static %}

{% block title %}Job Subscription Plans - Remote Ready Jobs{% endblock %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
    
    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }
    .float-on-hover:hover { animation: float 3s ease-in-out infinite; }
    
    .glass-effect {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .faq-transition {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }
    .faq-active .faq-transition {
        max-height: 500px;
    }
    .faq-active .faq-icon {
        transform: rotate(180deg);
    }
    
    #info-modal.hidden { display: none; }
    #modal-panel { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
</style>

<script src="https://js.paystack.co/v1/inline.js"></script>

<div class="bg-gray-50 min-h-screen">
    
    <div class="pt-20 pb-12 px-6">
        <div class="max-w-4xl mx-auto text-center animate-fade-in-up">
            <span class="text-purple-600 font-bold uppercase tracking-widest text-sm">Subscription Plans</span>
            <h1 class="text-4xl md:text-6xl font-extrabold text-gray-900 mt-4 mb-8">
                Verified Jobs, <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-indigo-600">Sent to Your WhatsApp.</span>
            </h1>
            
            <div class="bg-white p-8 rounded-3xl shadow-sm border border-purple-50 text-left md:text-center leading-relaxed text-gray-600 space-y-4">
                <p>
                    Finding remote jobs can be <span class="font-bold text-gray-800">time-consuming, overwhelming, and frustrating</span> especially if you’re juggling work, school, or personal responsibilities. 
                </p>
                <p>
                    <strong>Ready Remote Jobs</strong> solves this by bringing verified, relevant remote job opportunities directly to you. You receive carefully selected job openings that match your skills, experience level, and career interests, sent straight to your <strong>WhatsApp and email every day.</strong>
                </p>
            </div>
        </div>
    </div>

    <div class="pb-20 px-6">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-10">
            
            <div class="pricing-card glass-effect rounded-3xl p-8 flex flex-col items-center border border-gray-100 float-on-hover animate-fade-in-up" style="animation-delay: 0.1s;">
                <h3 class="text-xl font-bold text-purple-600 mb-1">Quick Job Hunt Sprint</h3>
                <p class="text-2xl font-black text-gray-900 mb-4">2 Weeks Plan</p>
                <div class="flex items-baseline mb-6">
                    <span class="text-5xl font-black text-gray-900">₦3,000</span>
                </div>
                <p class="text-gray-500 text-center text-sm mb-8">Personalized remote job alerts via WhatsApp and email for 14 days. Ideal for active seekers wanting fast access.</p>
                <ul class="w-full space-y-4 mb-10 text-sm">
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> Daily personalized alerts</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> WhatsApp & Email delivery</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> 14 Days duration</li>
                </ul>
                <button onclick="openModal('2_weeks', '2 Weeks Plan')" class="w-full py-4 rounded-2xl font-bold bg-gray-900 text-white hover:bg-gray-800 transition-all active:scale-95 shadow-lg">Start My Subscription</button>
            </div>

            <div class="pricing-card glass-effect rounded-3xl p-8 flex flex-col items-center border-2 border-purple-400 ring-4 ring-purple-100 relative float-on-hover animate-fade-in-up" style="animation-delay: 0.2s;">
                <span class="absolute -top-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-widest shadow-lg">Most Popular</span>
                <h3 class="text-xl font-bold text-purple-600 mb-1">Consistent Daily Opportunities</h3>
                <p class="text-2xl font-black text-gray-900 mb-4">1 Month Plan</p>
                <div class="flex items-baseline mb-6">
                    <span class="text-5xl font-black text-gray-900">₦5,000</span>
                </div>
                <p class="text-gray-500 text-center text-sm mb-8">Verified remote jobs delivered every day for 30 days. Perfect for steady searching while improving your resume.</p>
                <ul class="w-full space-y-4 mb-10 text-sm">
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> Daily personalized alerts</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> High priority support</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> 30 Days duration</li>
                </ul>
                <button onclick="openModal('1_month', '1 Month Plan')" class="w-full py-4 rounded-2xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 text-white transition-all active:scale-95 shadow-xl hover:shadow-purple-200">Start My Subscription</button>
            </div>

            <div class="pricing-card glass-effect rounded-3xl p-8 flex flex-col items-center border border-gray-100 float-on-hover animate-fade-in-up" style="animation-delay: 0.3s;">
                <h3 class="text-xl font-bold text-purple-600 mb-1">Long-Term Support</h3>
                <p class="text-2xl font-black text-gray-900 mb-4">3 Months Plan</p>
                <div class="flex items-baseline mb-6">
                    <span class="text-5xl font-black text-gray-900">₦10,000</span>
                </div>
                <p class="text-gray-500 text-center text-sm mb-8">Uninterrupted daily alerts for 90 days. Best for beginners, switchers, and those targeting competitive roles.</p>
                <ul class="w-full space-y-4 mb-10 text-sm">
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> Daily personalized alerts</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> Long-term career support</li>
                    <li class="flex items-center text-gray-600"><i class="fas fa-check-circle text-purple-500 mr-3"></i> 90 Days duration</li>
                </ul>
                <button onclick="openModal('3_months', '3 Months Plan')" class="w-full py-4 rounded-2xl font-bold bg-gray-900 text-white hover:bg-gray-800 transition-all active:scale-95 shadow-lg">Start My Subscription</button>
            </div>
        </div>
    </div>

    <div class="bg-white py-20 px-6">
        <div class="max-w-4xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Frequently Asked Questions</h2>
                <p class="text-gray-500 mt-2">Everything you need to know about our job alert service.</p>
            </div>

            <div class="space-y-4">
                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">1. What kind of jobs will I receive?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            You will receive verified remote job opportunities that match your skills, experience level, and career interests, including non-technical and entry-level roles.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">2. How will I receive the job alerts?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            Job alerts are sent daily to your WhatsApp and email, ensuring you never miss an opportunity.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">3. Are all subscription plans different?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            No. All plans offer the same features and benefits. The only difference is the duration of access: 2 weeks, 1 month, or 3 months.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">4. Will I get notified before others?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            Yes. Subscribers receive early notifications when new jobs are posted on the Ready Remote Jobs website—before non-subscribers.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">5. Do you apply for jobs on my behalf?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            No. We send you the jobs, but you are responsible for submitting your applications. This gives you full control over where and how you apply.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">6. Are the jobs guaranteed?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm space-y-2">
                            <p>While no platform can guarantee job placement, our service increases your chances by:</p>
                            <ul class="list-disc ml-5">
                                <li>Saving time</li>
                                <li>Sending relevant opportunities</li>
                                <li>Helping you apply early</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">7. Is this suitable for beginners?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm space-y-2">
                            <p>Yes. This service is especially helpful for beginners, career switchers, busy professionals, and anyone struggling to find remote jobs consistently.</p>
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">8. Can I cancel my subscription?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            Subscriptions run for the selected duration and expire automatically. You can choose whether or not to renew.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">9. Do I need technical skills to subscribe?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            No. Many of the jobs shared are non-technical and beginner-friendly.
                        </div>
                    </div>
                </div>

                <div class="border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
                    <button onclick="toggleFAQ(this)" class="w-full px-6 py-5 text-left flex justify-between items-center hover:bg-gray-50 transition-all">
                        <span class="font-bold text-gray-800">10. How soon do I start receiving alerts?</span>
                        <i class="fas fa-chevron-down faq-icon transition-transform text-purple-600"></i>
                    </button>
                    <div class="faq-transition bg-gray-50">
                        <div class="px-6 pb-5 text-gray-600 text-sm">
                            Once your subscription is confirmed, you’ll start receiving job alerts within 24 hours.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="info-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity bg-gray-900 bg-opacity-75" aria-hidden="true" onclick="closeModal()"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        
        <div id="modal-panel" class="inline-block align-bottom bg-white rounded-3xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full scale-95 opacity-0">
            <div class="px-8 pt-8 pb-6">
                <div class="text-center mb-6">
                    <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-purple-100 mb-4">
                        <i class="fas fa-user-edit text-purple-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900" id="modal-title">Personalize Your Alerts</h3>
                    <p class="text-sm text-gray-500 mt-2">Personalize your jobs before paying securely.</p>
                </div>

                <div class="space-y-4">
                    <input type="hidden" id="current-plan-key">
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">WhatsApp Number</label>
                        <input type="text" id="whatsapp_input" required placeholder="e.g. +234 812 345 6789"
                               class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Preferred Job Category</label>
                        <select id="category_input" required 
                                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none transition-all bg-white">
                            <option value="" disabled selected>Select your interest...</option>
                            <option value="Social Media Management">Social Media Management</option>
                            <option value="Graphic Design">Graphic Design</option>
                            <option value="Content Writing">Content Writing</option>
                            <option value="Software Development">Software Development</option>
                            <option value="Virtual Assistant">Virtual Assistant</option>
                            <option value="Data Entry">Data Entry</option>
                            <option value="Customer Support">Customer Support</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">
                            Referral Code <span class="text-xs font-normal text-gray-400">(Optional)</span>
                        </label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-4 flex items-center text-gray-400">
                                <i class="fas fa-ticket-alt"></i>
                            </span>
                            <input type="text" id="referral_input" maxlength="6" 
                                placeholder="Enter 6-digit code"
                                class="w-full pl-11 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none transition-all uppercase placeholder:normal-case">
                        </div>
                        <p class="text-[10px] text-gray-400 mt-1 ml-1">If you were referred by an ambassador, enter their code here.</p>
                    </div>
                </div>
            </div>

            <div class="px-8 py-6 bg-gray-50 flex flex-col sm:flex-row-reverse gap-3">
                <button type="button" id="submit-btn" onclick="payWithPaystack()" class="w-full py-3 px-6 bg-purple-700 text-white rounded-xl font-bold hover:bg-purple-800 transition-all shadow-lg flex items-center justify-center">
                    <span id="btn-text">Proceed to Payment</span>
                    <div id="btn-spinner" class="hidden flex items-center">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Initializing...
                    </div>
                </button>
                <button type="button" onclick="closeModal()" id="cancel-btn" class="w-full py-3 px-6 bg-white text-gray-600 border border-gray-200 rounded-xl font-bold hover:bg-gray-100 transition-all">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // FAQ Toggle Logic
    function toggleFAQ(button) {
        const item = button.parentElement;
        const isActive = item.classList.contains('faq-active');
        
        // Close all other FAQs
        document.querySelectorAll('.faq-active').forEach(el => {
            if (el !== item) el.classList.remove('faq-active');
        });

        // Toggle current FAQ
        item.classList.toggle('faq-active');
    }

    const submitBtn = document.getElementById('submit-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const btnText = document.getElementById('btn-text');
    const btnSpinner = document.getElementById('btn-spinner');

    function openModal(planKey, planName) {
        submitBtn.disabled = false;
        cancelBtn.classList.remove('invisible');
        btnText.classList.remove('hidden');
        btnSpinner.classList.add('hidden');
        submitBtn.classList.add('bg-purple-700');
        
        document.getElementById('current-plan-key').value = planKey;

        const modal = document.getElementById('info-modal');
        const panel = document.getElementById('modal-panel');
        
        modal.classList.remove('hidden');
        setTimeout(() => {
            panel.classList.remove('scale-95', 'opacity-0');
            panel.classList.add('scale-100', 'opacity-100');
        }, 10);
    }

    function closeModal() {
        const modal = document.getElementById('info-modal');
        const panel = document.getElementById('modal-panel');
        panel.classList.remove('scale-100', 'opacity-100');
        panel.classList.add('scale-95', 'opacity-0');
        setTimeout(() => { modal.classList.add('hidden'); }, 300);
    }

    function payWithPaystack() {
        const planKey = document.getElementById('current-plan-key').value;
        const whatsapp = document.getElementById('whatsapp_input').value;
        const category = document.getElementById('category_input').value;
        const referral = document.getElementById('referral_input').value;

        if (!whatsapp || !category) {
            alert("Please fill in all fields.");
            return;
        }

        submitBtn.disabled = true;
        btnText.classList.add('hidden');
        btnSpinner.classList.remove('hidden');

        const formData = new FormData();
        formData.append('whatsapp_number', whatsapp);
        formData.append('interest_category', category);
        formData.append('referral_code', referral);
        formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');

        fetch(`/subscription/pay/${planKey}/`, {
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                let handler = PaystackPop.setup({
                    key: '{{ paystack_public_key }}', 
                    email: '{{ request.user.email }}',
                    amount: data.amount_kobo,
                    ref: data.reference,
                    access_code: data.access_code, 
                    onClose: function() {
                        submitBtn.disabled = false;
                        btnText.classList.remove('hidden');
                        btnSpinner.classList.add('hidden');
                    },
                    callback: function(response) {
                        window.location.href = `/subscription/verify/?reference=${response.reference}`;
                    }
                });
                handler.openIframe();
            } else {
                alert("Error initializing payment. Please try again.");
                location.reload();
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert("Connection error.");
            location.reload();
        });
    }
</script>
{% endblock %}