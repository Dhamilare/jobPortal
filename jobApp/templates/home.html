{% extends 'base.html' %}

{% block title %}Home - Job Application Portal{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <section class="hero-section bg-gradient-to-r from-blue-600 to-purple-600 text-white py-20 px-6 md:px-8 lg:px-12 text-center relative overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-10" style="background-image: url('https://placehold.co/1920x1080/ffffff/000000?text=Abstract+Background'); background-size: cover; background-position: center;"></div>
        <div class="container mx-auto relative z-10">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold leading-tight mb-4 animate-fade-in-up">
                Find Your Dream Job Today
            </h1>
            <p class="text-lg md:text-xl mb-8 max-w-2xl mx-auto animate-fade-in-up delay-200">
                Connecting talented individuals with leading companies. Your next career move starts here.
            </p>
            <div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-4 animate-fade-in-up delay-400">
                <a href="{% url 'job_list' %}" class="bg-white text-blue-600 px-8 py-3 rounded-full font-semibold shadow-lg hover:bg-gray-100 transition-all duration-300 transform hover:scale-105 inline-flex items-center justify-center">
                    <i class="fas fa-briefcase mr-2"></i> Browse Jobs
                </a>
                <a href="{% url 'register' %}" class="bg-transparent border-2 border-white text-white px-8 py-3 rounded-full font-semibold hover:bg-white hover:text-blue-600 transition-all duration-300 transform hover:scale-105 inline-flex items-center justify-center">
                    <i class="fas fa-user-plus mr-2"></i> Register Now
                </a>
            </div>
        </div>
    </section>

    <!-- Verified Jobs Section with Carousel -->
    <section class="py-16 px-6 md:px-8 lg:px-12 bg-gray-50">
        <div class="container mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 flex items-center justify-center">
                <i class="fas fa-check-circle text-green-600 mr-3"></i> Verified Job Openings
            </h2>
            <div class="relative">
                <button id="carousel-prev" class="absolute left-0 top-1/2 -translate-y-1/2 bg-white p-3 rounded-full shadow-lg z-10 focus:outline-none hover:bg-gray-100 transition-colors duration-200 hidden md:block">
                    <i class="fas fa-chevron-left text-gray-700"></i>
                </button>
                <div id="job-carousel" class="flex overflow-x-auto snap-x snap-mandatory scroll-smooth pb-4 no-scrollbar">
                    {% if verified_jobs %}
                        {% for job in verified_jobs %}
                            <div class="flex-none w-full md:w-1/2 lg:w-1/3 p-4 snap-center">
                                <div class="bg-white rounded-lg p-6 card-shadow h-full flex flex-col justify-between transform transition-transform duration-300 hover:scale-105">
                                    <div>
                                        <h3 class="text-xl font-semibold text-gray-900 mb-2 flex items-center">
                                            <i class="fas fa-building text-blue-600 mr-2"></i> {{ job.title }}
                                        </h3>
                                        <p class="text-blue-600 mb-2 flex items-center">
                                            <i class="fas fa-map-marker-alt mr-2 text-gray-500"></i> {{ job.company_name }} - {{ job.location }}
                                        </p>
                                        <p class="text-gray-600 text-sm mb-4 line-clamp-3">{{ job.description }}</p>
                                    </div>
                                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center text-sm text-gray-500 mt-auto">
                                        <div class="flex flex-wrap gap-2 mb-2 sm:mb-0">
                                            <span class="inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">
                                                <i class="fas fa-clock mr-1"></i> {{ job.job_type }}
                                            </span>
                                            {% if job.category %}<span class="inline-flex items-center px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">
                                                <i class="fas fa-folder-open mr-1"></i> {{ job.category.name }}
                                            </span>{% endif %}
                                        </div>
                                        <div class="text-right w-full sm:w-auto">
                                            <p class="text-xs text-gray-500 mb-2">Posted {{ job.date_posted|timesince }} ago</p>
                                            <a href="{% url 'job_detail' job.id %}" class="text-blue-600 hover:underline font-medium inline-flex items-center">
                                                View Details & Apply <i class="fas fa-arrow-right ml-2"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-center text-gray-600 col-span-full w-full py-10">
                            <i class="fas fa-info-circle mr-2"></i> No active jobs found at the moment. Please check back later!
                        </p>
                    {% endif %}
                </div>
                <button id="carousel-next" class="absolute right-0 top-1/2 -translate-y-1/2 bg-white p-3 rounded-full shadow-lg z-10 focus:outline-none hover:bg-gray-100 transition-colors duration-200 hidden md:block">
                    <i class="fas fa-chevron-right text-gray-700"></i>
                </button>
            </div>
            <div class="text-center mt-12">
                <a href="{% url 'job_list' %}" class="btn-primary inline-block w-auto">
                    <i class="fas fa-list-alt mr-2"></i> View All Jobs
                </a>
            </div>
        </div>
    </section>

    <!-- Testimonial Section -->
    <section class="py-16 px-6 md:px-8 lg:px-12 bg-white">
        <div class="container mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 flex items-center justify-center">
                <i class="fas fa-quote-left text-blue-600 mr-3"></i> What Our Users Say
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Testimonial Card 1 -->
                <div class="bg-gray-50 rounded-lg p-6 card-shadow border border-gray-200">
                    <p class="text-gray-700 italic mb-4 text-center">"This portal helped me land my dream job in just a few weeks! The interface is intuitive and the job listings are highly relevant."</p>
                    <div class="flex flex-col items-center">
                        <img src="https://placehold.co/64x64/F0F0F0/888888?text=JD" alt="User Avatar" class="w-16 h-16 rounded-full mb-3 border-2 border-blue-300">
                        <p class="font-semibold text-gray-900">Jane Doe</p>
                        <p class="text-sm text-gray-600">Software Engineer</p>
                    </div>
                </div>
                <!-- Testimonial Card 2 -->
                <div class="bg-gray-50 rounded-lg p-6 card-shadow border border-gray-200">
                    <p class="text-gray-700 italic mb-4 text-center">"The email verification process was smooth, and the dashboard helps me track all my applications easily. Highly recommended!"</p>
                    <div class="flex flex-col items-center">
                        <img src="https://placehold.co/64x64/F0F0F0/888888?text=AS" alt="User Avatar" class="w-16 h-16 rounded-full mb-3 border-2 border-green-300">
                        <p class="font-semibold text-gray-900">Alex Smith</p>
                        <p class="text-sm text-gray-600">Marketing Specialist</p>
                    </div>
                </div>
                <!-- Testimonial Card 3 -->
                <div class="bg-gray-50 rounded-lg p-6 card-shadow border border-gray-200">
                    <p class="text-gray-700 italic mb-4 text-center">"Finding relevant jobs was never easier. The powerful search functionality saved me so much time. Thank you, JobPortal!"</p>
                    <div class="flex flex-col items-center">
                        <img src="https://placehold.co/64x64/F0F0F0/888888?text=EM" alt="User Avatar" class="w-16 h-16 rounded-full mb-3 border-2 border-purple-300">
                        <p class="font-semibold text-gray-900">Emily White</p>
                        <p class="text-sm text-gray-600">Data Analyst</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section with Accordion -->
    <section class="py-16 px-6 md:px-8 lg:px-12 bg-gray-100">
        <div class="container mx-auto max-w-3xl">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 flex items-center justify-center">
                <i class="fas fa-question-circle text-blue-600 mr-3"></i> Frequently Asked Questions
            </h2>
            <div class="space-y-4">
                <!-- FAQ Item 1 -->
                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <div class="accordion-header flex justify-between items-center p-5 cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors duration-200">
                        <h3 class="text-lg font-medium text-gray-800 flex items-center">
                            <i class="fas fa-question-circle text-blue-500 mr-3"></i> How do I apply for a job?
                        </h3>
                        <i class="fas fa-chevron-down text-gray-500 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="accordion-content p-5 text-gray-700 border-t border-gray-200 hidden">
                        <p>To apply for a job, you must first register and log in. Once logged in, navigate to the job listing you are interested in and click the "Apply Now" button which will redirect you to the company's external application page.</p>
                    </div>
                </div>
                <!-- FAQ Item 2 -->
                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <div class="accordion-header flex justify-between items-center p-5 cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors duration-200">
                        <h3 class="text-lg font-medium text-gray-800 flex items-center">
                            <i class="fas fa-question-circle text-blue-500 mr-3"></i> Is email verification required?
                        </h3>
                        <i class="fas fa-chevron-down text-gray-500 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="accordion-content p-5 text-gray-700 border-t border-gray-200 hidden">
                        <p>Yes, email verification is required for all new registrations. After signing up, a verification link will be sent to your registered email address. Please click the link to activate your account before attempting to log in.</p>
                    </div>
                </div>
                <!-- FAQ Item 3 -->
                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <div class="accordion-header flex justify-between items-center p-5 cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors duration-200">
                        <h3 class="text-lg font-medium text-gray-800 flex items-center">
                            <i class="fas fa-question-circle text-blue-500 mr-3"></i> How can I track my applications?
                        </h3>
                        <i class="fas fa-chevron-down text-gray-500 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="accordion-content p-5 text-gray-700 border-t border-gray-200 hidden">
                        <p>Once logged in, you can visit your personal dashboard where you will find a summary of all the jobs for which you've clicked the 'Apply' link, their current status (as updated by moderators), and options to manage your profile.</p>
                    </div>
                </div>
                <!-- FAQ Item 4 -->
                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <div class="accordion-header flex justify-between items-center p-5 cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors duration-200">
                        <h3 class="text-lg font-medium text-gray-800 flex items-center">
                            <i class="fas fa-question-circle text-blue-500 mr-3"></i> Can I update my profile information?
                        </h3>
                        <i class="fas fa-chevron-down text-gray-500 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="accordion-content p-5 text-gray-700 border-t border-gray-200 hidden">
                        <p>Absolutely! From your applicant dashboard, you can access your profile settings to update your personal details, change your password, and modify your email address.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Job Carousel Functionality
        const carousel = document.getElementById('job-carousel');
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');

        if (carousel && prevBtn && nextBtn) {
            const scrollAmount = carousel.querySelector('.flex-none') ? carousel.querySelector('.flex-none').offsetWidth + 32 : 300; // Card width + gap (p-4 * 2 = 32px)

            prevBtn.addEventListener('click', () => {
                carousel.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            });

            nextBtn.addEventListener('click', () => {
                carousel.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            });

            // Show/hide buttons based on scroll position
            const updateCarouselButtons = () => {
                if (carousel.scrollWidth > carousel.clientWidth) {
                    // Only show buttons if there's content to scroll
                    prevBtn.classList.remove('hidden');
                    nextBtn.classList.remove('hidden');

                    if (carousel.scrollLeft === 0) {
                        prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    } else {
                        prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    }

                    if (carousel.scrollLeft + carousel.clientWidth >= carousel.scrollWidth - 1) { // -1 for minor rounding differences
                        nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    } else {
                        nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    }
                } else {
                    // Hide buttons if no scrollbar is needed
                    prevBtn.classList.add('hidden');
                    nextBtn.classList.add('hidden');
                }
            };

            carousel.addEventListener('scroll', updateCarouselButtons);
            window.addEventListener('resize', updateCarouselButtons); // Recalculate on resize
            updateCarouselButtons(); // Initial check
        }


        // FAQ Accordion Functionality
        const accordionHeaders = document.querySelectorAll('.accordion-header');

        accordionHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const accordionItem = header.closest('.accordion-item');
                const accordionContent = accordionItem.querySelector('.accordion-content');
                const icon = header.querySelector('.accordion-icon, .fa-chevron-down'); // Select the Font Awesome icon

                // Toggle visibility of the content
                accordionContent.classList.toggle('hidden');

                // Toggle icon rotation
                icon.classList.toggle('rotate-180');

                // Close other open accordions
                accordionHeaders.forEach(otherHeader => {
                    if (otherHeader !== header) {
                        const otherAccordionItem = otherHeader.closest('.accordion-item');
                        const otherAccordionContent = otherAccordionItem.querySelector('.accordion-content');
                        const otherIcon = otherHeader.querySelector('.accordion-icon, .fa-chevron-down');

                        if (!otherAccordionContent.classList.contains('hidden')) {
                            otherAccordionContent.classList.add('hidden');
                            otherIcon.classList.remove('rotate-180');
                        }
                    }
                });
            });
        });
    });
</script>
{% endblock %}
